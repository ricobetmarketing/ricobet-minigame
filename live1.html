<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Live Realm — Dealer’s Quick Quiz</title>
<style>
  :root{ --bg:#0a0f1e; --ink:#eaf2ff; --mut:#9fb0d9; --g1:#71e1ff; --g2:#25c3ff; }
  *{box-sizing:border-box} html,body{height:100%}
  body{
    margin:0; color:var(--ink);
    background:radial-gradient(1200px 800px at 70% -10%, #18244d 0%, #0a0f1e 55%, #05070d 100%);
    font-family:ui-sans-serif,system-ui,-apple-system,"Segoe UI",Roboto,Arial;
    display:flex; align-items:center; justify-content:center; padding:20px;
  }
  a.back{
    position:fixed; left:12px; top:12px; z-index:10; text-decoration:none;
    background:rgba(0,0,0,.5); padding:8px 12px; border-radius:10px; color:#fff; font-weight:700;
  }
  .wrap{width:min(820px,96vw)}
  .card{
    position:relative; border-radius:22px; padding:18px;
    background:linear-gradient(180deg,#1b2a56,#0f1832);
    outline:1px solid rgba(255,255,255,.08); box-shadow:0 16px 60px rgba(0,0,0,.55);
  }
  h1{margin:0 0 8px; font-size:20px; font-weight:900; text-transform:uppercase}
  p.sub{margin:0 6px 16px; color:var(--mut)}
  .q{
    background:rgba(0,0,0,.28); border:1px solid rgba(255,255,255,.1); border-radius:14px;
    padding:14px; margin:10px 0;
  }
  .opts{display:grid; gap:8px; margin-top:8px}
  .opts button{
    text-align:left; border:0; border-radius:12px; padding:10px 12px; font-weight:800; cursor:pointer;
    background:#121a36; color:#eaf2ff; outline:1px solid rgba(255,255,255,.08);
  }
  .opts button.sel{outline:2px solid rgba(113,225,255,.8)}
  .cta{
    display:flex; gap:10px; margin-top:12px; justify-content:flex-end; align-items:center;
  }
  .primary{
    border:0; border-radius:12px; padding:10px 14px; font-weight:900; cursor:pointer;
    background:linear-gradient(to right, var(--g1), var(--g2)); color:#061018;
    box-shadow:0 0 18px rgba(113,225,255,.5), inset 0 -3px 0 rgba(0,0,0,.35);
  }
  .code{
    display:none; margin-top:10px; font-family:ui-monospace,SFMono-Regular,Menlo,monospace;
    letter-spacing:.5px; padding:10px 12px; border-radius:12px; background:#0a0d1a; outline:1px dashed rgba(160,220,255,.35);
  }
  .copy{display:none; margin-top:8px; border:0; border-radius:10px; padding:8px 10px; font-weight:900; background:#2b2b2b; color:#fff}
</style>
</head>
<body>
  <a class="back" href="index.html">← Back</a>

  <div class="wrap">
    <div class="card">
      <h1>Dealer’s Quick Quiz</h1>
      <p class="sub">Answer 3 quick questions. Get 2 or more correct to reveal your Live voucher. Submitting locks you to <b>Live</b> for this event.</p>

      <div id="quiz"></div>

      <div class="cta">
        <span id="status" style="color:#9fb0d9"></span>
        <button class="primary" id="submitBtn">Submit</button>
      </div>

      <div class="code" id="codeBox">LIVE-QUIZ-XXXX</div>
      <button class="copy" id="copyBtn">Copy Code</button>
    </div>
  </div>

<script src="assets/common.js"></script>
<script>
/* Path lock guard */
const chk = getChoice();
if (chk && chk !== 'live') {
  alert('You already started Slot. Live is locked for this event.');
  location.replace('index.html');
}

/* Config */
const QUESTIONS = [
  {
    q: 'In Blackjack, what does a “natural” pay (commonly)?',
    a: ['1:1', '3:2', '2:1'], correct: 1
  },
  {
    q: 'In Baccarat, which hand often takes a third card by rule?',
    a: ['Banker', 'Player', 'Both never draw'], correct: 1
  },
  {
    q: 'Roulette: what are the chances of landing a single number in European roulette?',
    a: ['1/37', '1/36', '1/38'], correct: 0
  }
];
const PASS_MARK = 2;
const CLAIM_KEY = 'live_quiz_claimed_v1';
const CODE = 'LIVE-ACE-QUIZ';

/* State */
const prior = localStorage.getItem(CLAIM_KEY);
if (prior) {
  document.getElementById('codeBox').style.display='inline-block';
  document.getElementById('codeBox').textContent = JSON.parse(prior).code || CODE;
  document.getElementById('copyBtn').style.display='inline-block';
}

/* Build quiz */
const quiz = document.getElementById('quiz');
QUESTIONS.forEach((it, qi)=>{
  const box = document.createElement('div'); box.className='q';
  box.innerHTML = `<div style="font-weight:900">${qi+1}. ${it.q}</div>`;
  const opts = document.createElement('div'); opts.className='opts';
  it.a.forEach((txt, ai)=>{
    const b = document.createElement('button');
    b.textContent = txt;
    b.addEventListener('click', ()=>{
      // toggle select
      [...opts.children].forEach(c=>c.classList.remove('sel'));
      b.classList.add('sel');
      b.dataset.sel = '1';
      box.dataset.choice = ai;
    });
    opts.appendChild(b);
  });
  box.appendChild(opts);
  quiz.appendChild(box);
});

const submitBtn = document.getElementById('submitBtn');
const statusEl = document.getElementById('status');
const codeBox = document.getElementById('codeBox');
const copyBtn = document.getElementById('copyBtn');

submitBtn.addEventListener('click', ()=>{
  const answers = [...document.querySelectorAll('.q')].map((q,i)=>{
    const choice = q.dataset.choice;
    return choice!==undefined ? Number(choice) : -1;
  });
  if (answers.some(a => a === -1)) { statusEl.textContent='Answer all questions.'; return; }

  // Lock path on submit
  setChoice('live');

  let score = 0;
  answers.forEach((a,i)=>{ if (a === QUESTIONS[i].correct) score++; });

  statusEl.textContent = `You got ${score}/${QUESTIONS.length}.`;
  if (score >= PASS_MARK) {
    codeBox.style.display='inline-block';
    codeBox.textContent = CODE;
    copyBtn.style.display='inline-block';
    localStorage.setItem(CLAIM_KEY, JSON.stringify({code: CODE, ts: Date.now(), score}));
  } else {
    codeBox.style.display='inline-block';
    codeBox.textContent = 'TRY-AGAIN-NEXT-TIME';
    copyBtn.style.display='none';
  }
});

copyBtn.addEventListener('click', ()=>{
  const t = codeBox.textContent.trim(); if (!t) return;
  navigator.clipboard.writeText(t).then(()=>{
    copyBtn.textContent='Copied!'; setTimeout(()=>copyBtn.textContent='Copy Code',1200);
  });
});
</script>
</body>
</html>
